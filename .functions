function http-vcloud-login {
    http --session=vcloud-ss-vagrant \
    --verify=no -a vagrant@ss \
    POST https://roecloud001/api/sessions \
    'Accept:application/*+xml;version=5.5' \
    --pretty colors
}

function http-vcloud {
  if [[ $@ =~ ^http ]]; then
    http --session=vcloud-ss-vagrant --verify=no --pretty colors --print hb "$@";
  else
    http --session=vcloud-ss-vagrant --verify=no --pretty colors --print hb "https://roecloud001$@";
  fi
}

function gitcloneall {
  if [ "$#" -lt 1  ]; then
    echo "Usage: gitcloneall git@github.com:YOUR_ORG [user[:pass]]"
    echo "Clones all repos of a GitHub org or user."
    return
  fi
  org=$(echo $1 | sed -e s/.*://)
  user=""
  if [ "$#" -eq 2  ]; then
    user="-u $2"
  fi
  curl $user -s https://api.github.com/users/$org/repos?per_page=200 | jq '.[] | .ssh_url' | sed -e s/git.*$org/$1/ | xargs -I % git clone %
}

function gitall {
  if [ "$#" -lt 1  ]; then
    echo "Usage: gitall pull|push|commit ..."
    echo "Starts a git command for each directory found in current dir."
    return
  fi
  if tput setaf 1 &> /dev/null; then
    BOLD=$(tput bold)
    RESET=$(tput sgr0)
  else
    BOLD=""
    RESET="\033[m"
  fi
  for DIR in `ls --color=never`;
  do
    if [ -d $DIR/.git ]; then
      echo $BOLD"Entering "$DIR$RESET
      pushd $DIR >/dev/null
      git "$@"
      popd >/dev/null
    fi
  done
}

function gitls {
  if [ "$#" -lt 1  ]; then
    dirs="."
  else
    dirs=$*
  fi
  if tput setaf 1 &> /dev/null; then
    tput sgr0
    if [[ $(tput colors) -ge 256 ]] 2>/dev/null; then
      RED=$(tput setaf 1)
      ORANGE=$(tput setaf 172)
      GREEN=$(tput setaf 70)
      PURPLE=$(tput setaf 141)
    else
      GREEN=$(tput setaf 2)
      PURPLE=$(tput setaf 1)

    fi
    BOLD=$(tput bold)
    RESET=$(tput sgr0)
  else
    GREEN="\033[1;32m"
    PURPLE="\033[1;35m"
    BOLD=""
    RESET="\033[m"
  fi

  for d in `find $dirs -name ".git"`; do
    # check if we're in a git repo
    git --git-dir=$d --work-tree=$d/.. rev-parse --is-inside-work-tree &>/dev/null # || return

    # quickest check for what branch we're on
    branch=$(git --git-dir=$d --work-tree=$d/.. symbolic-ref -q HEAD | sed -e 's|^refs/heads/||')

    # check if it's dirty (via github.com/sindresorhus/pure)
    dirty=$(git --git-dir=$d --work-tree=$d/.. diff --quiet --ignore-submodules HEAD &>/dev/null; [ $? -eq 1 ]&& echo -e "*")
    dir=`echo $d | sed -e 's|^\.\/||' -e 's|\/.git||'`
    FOLDER=$GREEN
    BRANCH=$PURPLE
    if [ "$branch" != "master" ]; then
      FOLDER=$ORANGE
      BRANCH=$ORANGE
    fi
    if [ "$dirty" = "*" ]; then
      FOLDER=$RED
      BRANCH=$RED
    fi
    echo $RESET$BOLD$FOLDER"$dir$RESET$BOLD on "$BRANCH$branch$dirty$RESET
  done
}

function gi() { curl -L -s https://www.gitignore.io/api/$@ ; }
